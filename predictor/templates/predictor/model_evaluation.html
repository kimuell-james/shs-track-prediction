{% extends 'predictor/main.html' %}

{% block content %}

<h1>ðŸ“ˆ Model Evaluation</h1>
<hr>

{% if no_data %}
<h3>No data available for evaluation.</h3>
{% else %}
<h3>School Year: {{ current_sy }}</h3>
<h3>Total records evaluated: {{ count }}</h3>
<h3>Accuracy: {{ accuracy }}%</h3>
<hr>

<h3>Classification Metrics</h3>
<!-- Table -->
<table class="table" cellpadding="5">
    <tr>
        <th>Label</th>
        <th>Precision</th>
        <th>Recall</th>
        <th>F1-Score</th>
        <th>Support</th>
    </tr>
    {% for label, metrics in report.items %}
    {% if label not in "accuracy macro avg weighted avg" %}
    <tr>
        <td>{{ label }}</td>
        <td>{{ metrics.precision|floatformat:2 }}</td>
        <td>{{ metrics.recall|floatformat:2 }}</td>
        <td>{{ metrics.f1_score|floatformat:2 }}</td>
        <td>{{ metrics.support }}</td>
    </tr>
    {% endif %}
    {% endfor %}
</table>
<hr>

<h3>Confusion Matrix</h3>
<div class="text-center">
    <img src="data:image/png;base64,{{ cm_base64 }}" class="img-fluid" alt="Confusion Matrix" />
</div>
<hr>

<h3>ROC Curve</h3>
<div class="text-center">
    <h5>ROC-AUC Score: <strong>{{ roc_auc }}</strong></h5>
    <img src="data:image/png;base64,{{ roc_base64 }}" class="img-fluid" alt="ROC Curve" />
</div>

{% endif %}
{% endblock %}